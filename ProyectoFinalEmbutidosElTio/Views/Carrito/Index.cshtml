@model ProyectoFinalEmbutidosElTio.Models.ViewModels.CartViewModel
@{
    ViewData["Title"] = "Tu Selección";
}

<div class="bg-charcoal-900 min-h-screen py-16 -mt-8 relative overflow-hidden">
    <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/wood-pattern.png')] opacity-5 pointer-events-none"></div>
    <div class="absolute top-0 right-0 w-2/3 h-2/3 bg-gradient-to-b from-rust-900/20 via-transparent to-transparent blur-3xl pointer-events-none"></div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">

        <div class="flex flex-col md:flex-row items-center justify-between mb-12 border-b border-white/10 pb-8 gap-6">
            <h1 class="text-3xl md:text-4xl font-black text-white font-slab uppercase tracking-wide flex items-center gap-4">
                <div class="w-14 h-14 rounded-sm bg-gradient-to-br from-rust-600 to-rust-800 flex items-center justify-center shadow-lg border border-white/10">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                    </svg>
                </div>
                Tu Selección
            </h1>

            @if (Model.Items.Any())
            {
                <div class="flex items-center gap-6">
                    <span class="text-gray-400 font-mono text-sm uppercase tracking-widest border-r border-white/10 pr-6 hidden md:block">
                        @Model.Items.Sum(x => x.Quantity) Unidades
                    </span>
                    <a asp-action="ClearCart" class="group flex items-center gap-2 text-xs font-bold text-red-500 uppercase tracking-widest hover:text-red-400 transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transition-transform group-hover:rotate-12" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                        </svg>
                        Vaciar Todo
                    </a>
                </div>
            }
        </div>

        @if (!Model.Items.Any())
        {
            <div class="bg-[#151515] border border-white/5 rounded-sm p-20 text-center shadow-2xl relative overflow-hidden group">
                <div class="absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-white/5 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700"></div>
                <div class="relative z-10">
                    <div class="mx-auto w-24 h-24 rounded-full border-2 border-dashed border-white/20 flex items-center justify-center mb-8 text-gray-600 group-hover:border-gold-500 group-hover:text-gold-500 transition-all duration-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                    </div>
                    <h2 class="text-3xl font-black text-white font-slab mb-4 uppercase tracking-wide">Tu mesa está vacía</h2>
                    <p class="text-gray-400 mb-10 max-w-md mx-auto font-light leading-relaxed">
                        Nuestros maestros carniceros tienen los mejores cortes listos para ti. ¿Empezamos?
                    </p>
                    <a asp-controller="Tienda" asp-action="Index" class="inline-flex items-center gap-3 px-10 py-4 bg-transparent border border-gold-500 text-gold-500 font-bold font-slab uppercase tracking-[0.2em] text-sm hover:bg-gold-500 hover:text-black transition-all shadow-[0_0_20px_rgba(234,179,8,0.1)] hover:shadow-[0_0_30px_rgba(234,179,8,0.4)]">
                        <span>Ir a la Despensa</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" /></svg>
                    </a>
                </div>
            </div>
        }
        else
        {
            <div class="lg:grid lg:grid-cols-12 lg:gap-16 items-start">

                <div class="lg:col-span-8 space-y-6">
                    @foreach (var item in Model.Items)
                    {
                        <div class="group bg-[#151515] border border-white/5 p-6 flex flex-col sm:flex-row gap-8 hover:border-gold-500/30 transition-all duration-300 shadow-lg relative overflow-hidden rounded-sm">

                            <div class="flex-shrink-0 w-full sm:w-32 h-32 bg-[#0a0a0a] overflow-hidden relative border border-white/10 group-hover:border-gold-500/50 transition-colors rounded-sm flex items-center justify-center">
                                <img src="@(string.IsNullOrEmpty(item.Producto.ImagenUrl) ? "https://via.placeholder.com/150" : item.Producto.ImagenUrl)"
                                     class="w-auto h-full max-h-full object-contain p-2 group-hover:scale-110 transition-transform duration-500"
                                     alt="@item.Producto.Nombre">
                            </div>

                            <div class="flex-1 flex flex-col justify-between py-1">
                                <div class="flex justify-between items-start mb-4">
                                    <div>
                                        <h3 class="text-xl font-black text-white font-slab uppercase tracking-wide group-hover:text-gold-500 transition-colors">
                                            <a asp-controller="Tienda" asp-action="Details" asp-route-id="@item.Producto.IdProducto">
                                                @item.Producto.Nombre
                                            </a>
                                        </h3>
                                        <p class="text-rust-500 text-xs font-bold uppercase tracking-widest mt-1">
                                            @(item.Producto.Categoria?.NombreTipo ?? "Producto Selecto")
                                        </p>
                                    </div>

                                    <a asp-action="RemoveFromCart" asp-route-productId="@item.Producto.IdProducto"
                                       class="text-gray-600 hover:text-red-500 transition-colors p-1"
                                       title="Eliminar producto">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                                        </svg>
                                    </a>
                                </div>

                                <div class="flex flex-col sm:flex-row items-end sm:items-center justify-between gap-4 mt-auto">

                                    <div class="flex items-center border border-white/20 rounded-sm bg-black/20">
                                        <a asp-action="DecreaseQuantity" asp-route-productId="@item.Producto.IdProducto"
                                           class="w-10 h-10 flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-colors border-r border-white/10">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M20 12H4" />
                                            </svg>
                                        </a>

                                        <div class="w-12 h-10 flex items-center justify-center text-white font-mono font-bold text-lg bg-transparent">
                                            @item.Quantity
                                        </div>

                                        <a asp-action="IncreaseQuantity" asp-route-productId="@item.Producto.IdProducto"
                                           class="w-10 h-10 flex items-center justify-center text-gray-400 hover:text-gold-500 hover:bg-white/10 transition-colors border-l border-white/10">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
                                            </svg>
                                        </a>
                                    </div>

                                    <div class="text-right">
                                        <div class="text-gray-500 text-[10px] uppercase font-bold tracking-wider mb-1">
                                            @item.Producto.Precio_final.ToString("0") Bs <span class="lowercase">x</span> un
                                        </div>
                                        <div class="text-2xl font-black text-white font-slab flex items-baseline justify-end gap-1">
                                            @item.Subtotal.ToString("0.##") <span class="text-sm text-gold-500 font-bold">Bs</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }

                    <div class="pt-8">
                        <a asp-controller="Tienda" asp-action="Index" class="inline-flex items-center gap-3 text-gray-400 hover:text-white font-bold text-xs uppercase tracking-[0.2em] transition-colors group">
                            <span class="w-8 h-8 rounded-full border border-gray-600 group-hover:border-white flex items-center justify-center transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                            </span>
                            Continuar Comprando
                        </a>
                    </div>
                </div>

                <div class="lg:col-span-4 mt-12 lg:mt-0">
                    <div class="bg-[#1a1a1a] border border-gold-500/20 p-8 sticky top-32 shadow-[0_0_60px_rgba(0,0,0,0.6)] rounded-sm relative overflow-hidden backdrop-blur-md">

                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-gold-500 to-transparent"></div>

                        <h2 class="text-xl font-black text-white font-slab uppercase tracking-wide mb-8 border-b border-white/10 pb-4 flex items-center justify-between">
                            Resumen
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gold-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" /></svg>
                        </h2>

                        <div class="space-y-4 mb-8 font-mono text-sm">
                            <div class="flex justify-between items-center text-gray-400">
                                <span>Subtotal</span>
                                <span class="text-white">@Model.Total.ToString("0.##") Bs</span>
                            </div>
                            <div class="flex justify-between items-center text-gray-400">
                                <span>Descuentos</span>
                                <span class="text-gray-600">- 0.00 Bs</span>
                            </div>
                            <div class="flex justify-between items-center text-gray-400">
                                <span>Envío</span>
                                <span class="text-green-500 font-bold uppercase text-xs tracking-wider border border-green-900/50 bg-green-900/20 px-2 py-0.5 rounded-sm">Gratis</span>
                            </div>
                        </div>

                        <div class="flex justify-between items-end border-t border-white/10 pt-6 mb-8">
                            <span class="text-lg font-bold text-white uppercase tracking-widest font-slab">Total</span>
                            <span class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-gold-300 to-gold-600 font-slab">@Model.Total.ToString("0")<span class="text-lg text-gray-500 ml-1 font-normal text-white">Bs</span></span>
                        </div>

                        <a asp-action="Checkout" class="group relative w-full flex justify-center py-5 px-4 border border-transparent text-sm font-black font-slab uppercase tracking-[0.2em] text-white bg-rust-600 overflow-hidden transition-all shadow-lg hover:shadow-rust-600/40">
                            <div class="absolute inset-0 bg-white/10 translate-y-full group-hover:translate-y-0 transition-transform duration-500 ease-out"></div>

                            <span class="relative z-10 flex items-center gap-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" /></svg>
                                Proceder al Pago
                            </span>
                        </a>

                        <div class="mt-8 text-center border-t border-white/5 pt-6">
                            <p class="text-[10px] text-gray-500 uppercase tracking-widest mb-3">Métodos de Pago Seguros</p>
                            <div class="flex justify-center gap-4 opacity-50 grayscale hover:grayscale-0 transition-all duration-500">
                                <svg class="h-6 w-auto text-white" viewBox="0 0 36 24" fill="currentColor"><rect width="36" height="24" rx="2" fill="#fff" fill-opacity="0.1" /><path d="M4 12h28" stroke="currentColor" stroke-width="2" /></svg>
                                <svg class="h-6 w-auto text-white" viewBox="0 0 36 24" fill="currentColor"><rect width="36" height="24" rx="2" fill="#fff" fill-opacity="0.1" /><circle cx="12" cy="12" r="6" fill="currentColor" fill-opacity="0.5" /><circle cx="24" cy="12" r="6" fill="currentColor" fill-opacity="0.5" /></svg>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>